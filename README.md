# WDNs-Dataset: Machine Learning for Optimal Water Distribution Network Design

## Overview
This repository contains the dataset and code for the final part of the study "Developing Machine Learning Models for Optimal Design of Water Distribution Networks Using Graph Theory-Based Features."In the main text of the study, various supervised machine learning methods are presented for predicting design diameters in water distribution networks. However, in the appendix, the ANN-WOA method is used to evaluate the reproducibility of the provided code. The project develops a Whale Optimization Algorithm (WOA) coupled with an Artificial Neural Network (ANN) to predict optimal pipe diameters in water distribution networks (WDNs) using topological and hydraulic features derived from graph theory. The dataset includes 600 synthetic WDNs with 85,745 pipe samples (81,829 after preprocessing) and 13 selected features, validated on the Hanoi WDN benchmark.

This README addresses reviewer feedback by documenting the dataset structure, preprocessing steps, training routines, and instructions to reproduce results (e.g., Figures and Tables) from the article. The code is provided in a Jupyter Notebook (`WDNs_Dataset.ipynb`) for interactive exploration.

## Dataset Description
The dataset consists of two parts: synthetic WDNs and the Hanoi benchmark WDN.

### Synthetic WDNs
- **Source**: 600 randomly generated WDNs, optimized for pipe diameters using a genetic algorithm (GA).
- **File**: `total_networks.csv` (85,745 rows, 14 columns after feature selection).
- **Features**: 13 topological and hydraulic features selected via XgBoost (originally 80 features):
  - `EDGE_Headloss_network`: Headloss in the pipe.
  - `NodeToEdge_Node_DCIN2`: Node degree centrality (in-degree, second order).
  - `EDGE_Velocity_network`: Flow velocity in the pipe.
  - `NodeToEdge_Node_DCOUT2`: Node degree centrality (out-degree, second order).
  - `EDGE_Length_network`: Pipe length.
  - `EDGE_Friction_network`: Pipe friction factor.
  - `NodeToEdge_NODE_AVE_DIM`: Average node dimension.
  - `NodeToEdge_NODE_MINpathRHW`: Minimum path length (resistance-weighted).
  - `EDGE_BetweennessCentrality_UndirectedRHW`: Betweenness centrality (undirected, resistance-weighted).
  - `NodeToEdge_Node_DCOUT1`: Node degree centrality (out-degree, first order).
  - `NodeToEdge_Node_DCIN1`: Node degree centrality (in-degree, first order).
  - `NodeToEdge_Demand_network`: Node demand.
  - `EDGE_BetweennessCentrality_directededlength`: Betweenness centrality (directed, length-weighted).
- **Target**: `EDGE_Diameter_network`: Optimal commercial pipe diameter (mm).
- **Preprocessing**:
  - Outlier removal: Removed samples with Z-scores > 4.2 (resulting in 81,829 samples).
  - Normalization: Min-max scaling applied to all features and target.

### Hanoi Benchmark WDN
- **Source**: Standard benchmark WDN for validation.
- **File**: `systembenchHanoi.csv` (34 rows, 14 columns).
- **Features**: Same 13 features as synthetic WDNs.
- **Target**: `EDGE_Diameter_network` (optimal diameters for Hanoi WDN).
- **Preprocessing**: Min-max scaling (combined with synthetic WDNs for consistent scaling).

## Code Description
The code is provided in a Jupyter Notebook (`WDNs_Dataset.ipynb`) that includes:
- **Preprocessing**: Loading datasets, feature selection, outlier removal, and min-max scaling.
- **Training**: WOA-ANN model to predict pipe diameters, with hyperparameter tuning (neurons, alpha, learning rate).
- **Evaluation**: Performance metrics (RÂ², MAE, MSE, RMSE) on the Hanoi WDN.
- **Output**: Predictions saved as `ANN_Pred.csv`.

### Files
- `total_networks.csv`: Synthetic WDN dataset (85,745 samples).
- `systembenchHanoi.csv`: Hanoi WDN dataset (34 samples).
- `WDNs_Dataset.ipynb`: Jupyter Notebook with preprocessing, training, and evaluation code.
- `ANN_Pred.csv`: Predicted diameters for Hanoi WDN (generated by running the notebook).

### Results
-  Results of diameter predictions for Kadu, Xg-LGB, and ANN-WOA methods in the Hanoi WDN :
- ![image](https://github.com/user-attachments/assets/8b1ae953-8aa2-4500-a6ec-5f5550db4b89)


## Dependencies
To run the code, ensure you have Python 3.8+ and the following libraries:
pip install numpy pandas scikit-learn mealpy
  
